{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"C:\\\\LABSREACT\\\\lab1\\\\screens\\\\HomeScreen.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport AsyncStorage from \"react-native-web/dist/exports/AsyncStorage\";\nimport uuidv1 from 'uuid/v1';\nimport _values from 'lodash.values';\nimport { AppLoading } from 'expo';\nimport * as Font from 'expo-font';\nimport Header from \"../components/Header\";\nimport Item from \"../components/Item\";\nimport FloatingButton from \"../components/FloatingButton\";\nimport { Button } from 'native-base';\nimport { SearchBar } from 'react-native-elements';\nexport var HomeScreen = function (_Component) {\n  _inherits(HomeScreen, _Component);\n\n  var _super = _createSuper(HomeScreen);\n\n  function HomeScreen() {\n    var _this;\n\n    _classCallCheck(this, HomeScreen);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      isDataReady: false,\n      items: {},\n      cloneItems: {},\n      search: ''\n    };\n\n    _this.componentDidMount = function () {\n      _this.loadItems();\n    };\n\n    _this.loadItems = function _callee() {\n      var getItems, parsedItems;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(Font.loadAsync({\n                Roboto: require(\"../node_modules/native-base/Fonts/Roboto.ttf\"),\n                Roboto_medium: require(\"../node_modules/native-base/Fonts/Roboto_medium.ttf\")\n              }));\n\n            case 3:\n              _context.next = 5;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem('laboneitems'));\n\n            case 5:\n              getItems = _context.sent;\n              parsedItems = JSON.parse(getItems);\n              console.log(parsedItems);\n\n              _this.setState({\n                isDataReady: true,\n                items: parsedItems || {},\n                cloneItems: parsedItems || {}\n              });\n\n              _context.next = 14;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](0);\n              alert('Application Error. Cannot load data.');\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[0, 11]], Promise);\n    };\n\n    _this.addTodo = function (item) {\n      var newItem = item;\n\n      if (Object.keys(newItem).length !== 0) {\n        _this.setState(function (prevState) {\n          var ID = uuidv1();\n\n          var newItemObject = _defineProperty({}, ID, {\n            id: ID,\n            date: newItem.date,\n            title: newItem.title,\n            text: newItem.text,\n            category: newItem.category\n          });\n\n          var newState = _objectSpread(_objectSpread({}, prevState), {}, {\n            items: _objectSpread(_objectSpread({}, prevState.items), newItemObject)\n          });\n\n          _this.saveItems(newState.items);\n\n          return _objectSpread({}, newState);\n        });\n      }\n    };\n\n    _this.deleteTodo = function (id) {\n      _this.setState(function (prevState) {\n        var items = prevState.items;\n        delete items[id];\n\n        var newState = _objectSpread(_objectSpread({}, prevState), items);\n\n        _this.saveItems(newState.items);\n\n        return _objectSpread({}, newState);\n      });\n    };\n\n    _this.clickItem = function (obj) {\n      _this.props.navigation.navigate('ShowScreen', {\n        date: obj.date,\n        title: obj.title,\n        text: obj.text,\n        category: obj.category\n      });\n    };\n\n    _this.saveItems = function (newItems) {\n      var saveItems = AsyncStorage.setItem('laboneitems', JSON.stringify(newItems));\n    };\n\n    _this.onPressFab = function () {\n      _this.props.navigation.navigate('AddTask', {\n        saveItem: _this.addTodo\n      });\n    };\n\n    _this.updateSearch = function (search) {\n      var filtered = _values(_this.state.cloneItems).filter(function (word) {\n        return (word.title.toLowerCase() + word.text.toLowerCase() + ' ' + new Date(word.date).toLocaleDateString(\"ru-RU\")).includes(search.toLowerCase());\n      });\n\n      console.log('[SEARCH]', filtered);\n\n      _this.setState({\n        items: filtered\n      });\n\n      _this.setState({\n        search: search\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(HomeScreen, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var search = this.state.search;\n      var isDataReady = this.state.isDataReady;\n\n      if (!isDataReady) {\n        return React.createElement(AppLoading, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 20\n          }\n        });\n      }\n\n      console.log(this.state.items);\n      console.log(_values(this.state.items));\n      return React.createElement(View, {\n        style: styles.container,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 13\n        }\n      }, React.createElement(Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 17\n        }\n      }), React.createElement(StatusBar, {\n        barStyle: \"light-content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 5\n        }\n      }), React.createElement(SearchBar, {\n        lightTheme: true,\n        placeholder: \"\\u041F\\u043E\\u0438\\u0441\\u043A...\",\n        onChangeText: this.updateSearch,\n        value: search,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 5\n        }\n      }), React.createElement(FlatList, {\n        data: _values(this.state.items),\n        contentContainerStyle: styles.content,\n        renderItem: function renderItem(row) {\n          return React.createElement(Item, {\n            dateT: row.item.date,\n            titleT: row.item.title,\n            textT: row.item.text,\n            categoryT: row.item.category,\n            id: row.item.id,\n            deleteTodo: _this2.deleteTodo,\n            clickItem: _this2.clickItem,\n            alertF: _this2.alertF,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 8\n            }\n          });\n        },\n        keyExtractor: function keyExtractor(item) {\n          return item.id;\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 17\n        }\n      }), React.createElement(View, {\n        style: {\n          width: 380,\n          height: 50,\n          alignItems: 'flex-end',\n          flexDirection: 'row'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 5\n        }\n      }, React.createElement(Button, {\n        onPress: this.onPressFab,\n        style: {\n          borderRadius: 0,\n          backgroundColor: '#1abc9c'\n        },\n        title: \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 7\n        }\n      }, React.createElement(Text, {\n        style: {\n          textAlign: \"center\",\n          width: 380,\n          color: '#FFFFFF'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 8\n        }\n      }, \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\"))));\n    }\n  }]);\n\n  return HomeScreen;\n}(Component);\nHomeScreen.navigationOptions = {\n  header: null\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  content: {\n    flex: 1,\n    alignSelf: 'stretch'\n  },\n  contentHeader: {\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n});\nexport default HomeScreen;","map":{"version":3,"sources":["C:/LABSREACT/lab1/screens/HomeScreen.js"],"names":["React","Component","uuidv1","_values","AppLoading","Font","Header","Item","FloatingButton","Button","SearchBar","HomeScreen","state","isDataReady","items","cloneItems","search","componentDidMount","loadItems","loadAsync","Roboto","require","Roboto_medium","AsyncStorage","getItem","getItems","parsedItems","JSON","parse","console","log","setState","alert","addTodo","item","newItem","Object","keys","length","prevState","ID","newItemObject","id","date","title","text","category","newState","saveItems","deleteTodo","clickItem","obj","props","navigation","navigate","newItems","setItem","stringify","onPressFab","saveItem","updateSearch","filtered","filter","word","toLowerCase","Date","toLocaleDateString","includes","styles","container","content","row","alertF","width","height","alignItems","flexDirection","borderRadius","backgroundColor","textAlign","color","navigationOptions","header","StyleSheet","create","flex","alignSelf","contentHeader","justifyContent"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Text, View, FlatList, StyleSheet, StatusBar, AsyncStorage } from 'react-native'\r\nimport uuidv1 from 'uuid/v1'\r\nimport _values from 'lodash.values'\r\nimport { AppLoading } from 'expo'\r\nimport * as Font from 'expo-font'\r\nimport Header from '../components/Header'\r\nimport Item from '../components/Item'\r\nimport FloatingButton from '../components/FloatingButton'\r\nimport { Button } from 'native-base'\r\n\r\nimport { SearchBar } from 'react-native-elements';\r\n\r\n\r\n\r\nexport class HomeScreen extends Component {\r\n\r\n    static navigationOptions = {\r\n        header: null\r\n    }\r\n\r\n    state = {\r\n        isDataReady: false,\r\n\t\titems: {},\r\n\t\tcloneItems: {},\r\n\t\tsearch: '',\r\n    }\r\n\t\r\n    componentDidMount = () => {\r\n        this.loadItems()\r\n    }\r\n\r\n    loadItems = async () => {\r\n        try {\r\n            await Font.loadAsync({\r\n                Roboto: require('../node_modules/native-base/Fonts/Roboto.ttf'),\r\n                Roboto_medium: require('../node_modules/native-base/Fonts/Roboto_medium.ttf')\r\n            })\r\n\r\n            const getItems = await AsyncStorage.getItem('laboneitems')\r\n\t\t\tconst parsedItems = JSON.parse(getItems)\r\n\t\t\tconsole.log(parsedItems);\r\n            this.setState({ isDataReady: true, items: parsedItems || {}, cloneItems: parsedItems || {} })\r\n        } catch (err) {\r\n            alert('Application Error. Cannot load data.')\r\n        }\r\n\t}\r\n\t\r\n\taddTodo = item => {\r\n\t\tconst newItem = item\r\n\t\tif(Object.keys(newItem).length !== 0) {\r\n        \tthis.setState(prevState => {\r\n        \t\tconst ID = uuidv1()\r\n        \t\tconst newItemObject = {\r\n        \t\t\t[ID]: {\r\n        \t\t\t\tid: ID,\r\n\t\t\t\t\t\tdate: newItem.date,\r\n\t\t\t\t\t\ttitle: newItem.title,\r\n\t\t\t\t\t\ttext: newItem.text,\r\n        \t\t\t\tcategory: newItem.category\r\n        \t\t\t}\r\n        \t\t}\r\n        \t\tconst newState = {\r\n        \t\t\t...prevState,\r\n        \t\t\titems: {\r\n        \t\t\t\t...prevState.items,\r\n        \t\t\t\t...newItemObject\r\n        \t\t\t}\r\n        \t\t}\r\n        \t\tthis.saveItems(newState.items)\r\n        \t\t// this.saveItems(newState.cloneItems)\r\n        \t\treturn { ...newState }\r\n        \t})\r\n        }\r\n\t}\r\n\r\n\tdeleteTodo = id => {\r\n        this.setState(prevState => {\r\n            const items = prevState.items\r\n            delete items[id]\r\n            const newState = {\r\n                ...prevState,\r\n                ...items\r\n            }\r\n            this.saveItems(newState.items)\r\n            return { ...newState }\r\n        })\r\n\t}\r\n\r\n\tclickItem = obj => {\r\n\t\tthis.props.navigation.navigate('ShowScreen', {\r\n\t\t\tdate: obj.date,\r\n\t\t\ttitle: obj.title,\r\n\t\t\ttext: obj.text,\r\n\t\t\tcategory: obj.category,\r\n\t\t})\r\n    }\r\n\r\n    saveItems = newItems => {\r\n        const saveItems = AsyncStorage.setItem('laboneitems', JSON.stringify(newItems))\r\n\t}\r\n\r\n\tonPressFab = () => {\r\n        this.props.navigation.navigate('AddTask', {\r\n            saveItem: this.addTodo\r\n        })\r\n\t}\r\n\r\n\tupdateSearch = search => {\r\n\r\n\t\tlet filtered = _values(this.state.cloneItems).filter(word =>\r\n\t\t\t(\r\n\t\t\t\tword.title.toLowerCase() +\r\n\t\t\t\tword.text.toLowerCase() +\r\n\t\t\t\t' ' +\r\n\t\t\t\tnew Date(word.date).toLocaleDateString(\"ru-RU\")\r\n\t\t\t)\r\n\t\t\t.includes(search.toLowerCase()));\r\n\r\n\t\tconsole.log('[SEARCH]',filtered);\r\n\r\n\t\tthis.setState({\r\n\t\t\titems: filtered\r\n\t\t});\r\n\t\tthis.setState({ search });\r\n\t};\r\n\r\n    render() {\r\n\t\tconst { search } = this.state;\r\n        const { isDataReady } = this.state\r\n\r\n        if (!isDataReady) {\r\n            return <AppLoading />\r\n        }\r\n\r\n\t\tconsole.log(this.state.items)\r\n\t\tconsole.log(_values(this.state.items))\r\n\r\n        return (\r\n            <View style={styles.container}>\r\n                <Header/>\r\n\t\t\t\t<StatusBar barStyle='light-content' />\r\n\t\t\t\t<SearchBar\r\n\t\t\t\t\tlightTheme\r\n\t\t\t\t\tplaceholder=\"Поиск...\"\r\n\t\t\t\t\tonChangeText={this.updateSearch}\r\n\t\t\t\t\tvalue={search}\r\n\t\t\t\t/>\r\n                <FlatList\r\n                    data={_values(this.state.items)}\r\n                    contentContainerStyle={styles.content}\r\n                    renderItem={row => {\r\n                        return (\r\n\t\t\t\t\t\t\t<Item\r\n\t\t\t\t\t\t\t\tdateT={row.item.date}\r\n\t\t\t\t\t\t\t\ttitleT={row.item.title}\r\n\t\t\t\t\t\t\t\ttextT={row.item.text}\r\n\t\t\t\t\t\t\t\tcategoryT={row.item.category}\r\n\t\t\t\t\t\t\t\tid={row.item.id}\r\n\t\t\t\t\t\t\t\tdeleteTodo={this.deleteTodo}\r\n\t\t\t\t\t\t\t\tclickItem = {this.clickItem}\r\n\t\t\t\t\t\t\t\talertF={this.alertF}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)\r\n                    }}\r\n                    keyExtractor={item => item.id}\r\n                />\r\n\t\t\t\t{/* <FloatingButton actionOnPress={this.onPressFab} /> */}\r\n\r\n\t\t\t\t<View style={{\r\n\t\t\t\t\t\r\n\t\t\t\t\twidth: 380,\r\n\t\t\t\t\theight: 50,\r\n\t\t\t\t\talignItems: 'flex-end',\r\n\t\t\t\t\tflexDirection: 'row',\r\n\t\t\t\t}}>\r\n\r\n\t\t\t\t\t\t<Button onPress={this.onPressFab} style={{ borderRadius: 0, backgroundColor: '#1abc9c'}} title=\"Добавить\">\r\n\t\t\t\t\t\t\t<Text style={{ textAlign: \"center\", width: 380, color: '#FFFFFF'}}>\r\n\t\t\t\t\t\t\t\tДобавить\r\n\t\t\t\t\t\t\t</Text>\r\n\t\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t</View>\r\n\r\n            </View>\r\n        )\r\n    }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n\tcontainer: {\r\n\t\tflex: 1\r\n\t},\r\n\tcontent: {\r\n\t\tflex: 1,\r\n\t\talignSelf: 'stretch'\r\n\t},\r\n\tcontentHeader: {\r\n\t\talignItems: 'center',\r\n\t\tjustifyContent: 'center'\r\n\t}\r\n})\r\n\r\nexport default HomeScreen"]},"metadata":{},"sourceType":"module"}